// ============================================================
// 03_copy_trait.rs - Copy ç±»å‹ä¸ Clone
// ============================================================
//
// ğŸ¯ å­¦ä¹ ç›®æ ‡ï¼šç†è§£å“ªäº›ç±»å‹ä¼š Copyï¼Œå“ªäº›ä¼š Move
//
// Copy: æ ˆä¸Šçš„ç®€å•ç±»å‹ï¼Œèµ‹å€¼æ—¶è‡ªåŠ¨å¤åˆ¶ï¼ŒåŸå€¼ä»æœ‰æ•ˆ
// Clone: æ˜¾å¼æ·±æ‹·è´ï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨ .clone()
//
// è¿è¡Œæ–¹å¼: cargo run --example 03_copy_trait
// ============================================================

fn main() {
    println!("=== Copy ç±»å‹ä¸ Clone ===\n");

    // --------------------------------------------------------
    // ğŸ“Œ Copy ç±»å‹ - èµ‹å€¼æ—¶è‡ªåŠ¨å¤åˆ¶
    // --------------------------------------------------------
    println!("ã€1ã€‘Copy ç±»å‹ - è‡ªåŠ¨å¤åˆ¶");
    println!();

    // æ•´æ•°æ˜¯ Copy çš„
    let x = 42;
    let y = x;  // å¤åˆ¶ï¼Œä¸æ˜¯ Moveï¼
    println!("  æ•´æ•° (i32):");
    println!("    x = {}", x);  // âœ… x ä»ç„¶æœ‰æ•ˆ
    println!("    y = {}", y);
    println!();

    // æµ®ç‚¹æ•°æ˜¯ Copy çš„
    let a = 3.14;
    let b = a;
    println!("  æµ®ç‚¹æ•° (f64):");
    println!("    a = {}", a);  // âœ… a ä»ç„¶æœ‰æ•ˆ
    println!("    b = {}", b);
    println!();

    // å¸ƒå°”å€¼æ˜¯ Copy çš„
    let flag1 = true;
    let flag2 = flag1;
    println!("  å¸ƒå°”å€¼ (bool):");
    println!("    flag1 = {}", flag1);  // âœ…
    println!("    flag2 = {}", flag2);
    println!();

    // å­—ç¬¦æ˜¯ Copy çš„
    let c1 = 'A';
    let c2 = c1;
    println!("  å­—ç¬¦ (char):");
    println!("    c1 = '{}'", c1);  // âœ…
    println!("    c2 = '{}'", c2);
    println!();

    // å…ƒç»„ï¼ˆå¦‚æœæ‰€æœ‰å…ƒç´ éƒ½æ˜¯ Copy çš„ï¼‰
    let tuple1 = (1, 2.0, true);
    let tuple2 = tuple1;
    println!("  å…ƒç»„ (i32, f64, bool):");
    println!("    tuple1 = {:?}", tuple1);  // âœ…
    println!("    tuple2 = {:?}", tuple2);
    println!();

    // --------------------------------------------------------
    // ğŸ“Œ å“ªäº›ç±»å‹å®ç°äº† Copyï¼Ÿ
    // --------------------------------------------------------
    println!("ã€2ã€‘Copy ç±»å‹æ¸…å•");
    println!();
    println!("  âœ… å®ç° Copy çš„ç±»å‹:");
    println!("     - æ‰€æœ‰æ•´æ•°ç±»å‹: i8, i16, i32, i64, i128, isize");
    println!("     - æ‰€æœ‰æ— ç¬¦å·æ•´æ•°: u8, u16, u32, u64, u128, usize");
    println!("     - æµ®ç‚¹ç±»å‹: f32, f64");
    println!("     - å¸ƒå°”ç±»å‹: bool");
    println!("     - å­—ç¬¦ç±»å‹: char");
    println!("     - å…ƒç»„ï¼ˆä»…å½“æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ Copy æ—¶ï¼‰");
    println!("     - æ•°ç»„ï¼ˆä»…å½“å…ƒç´ ç±»å‹æ˜¯ Copy æ—¶ï¼‰");
    println!("     - å¼•ç”¨ &Tï¼ˆä½† &mut T ä¸æ˜¯ Copyï¼‰");
    println!();
    println!("  âŒ ä¸æ˜¯ Copy çš„ç±»å‹:");
    println!("     - Stringï¼ˆå †ä¸Šåˆ†é…ï¼‰");
    println!("     - Vec<T>ï¼ˆå †ä¸Šåˆ†é…ï¼‰");
    println!("     - Box<T>ï¼ˆå †ä¸Šåˆ†é…ï¼‰");
    println!("     - ä»»ä½•æ‹¥æœ‰å †èµ„æºçš„ç±»å‹");
    println!();

    // --------------------------------------------------------
    // ğŸ“Œ Clone - æ˜¾å¼æ·±æ‹·è´
    // --------------------------------------------------------
    println!("ã€3ã€‘Clone - æ˜¾å¼æ·±æ‹·è´");
    println!();

    let s1 = String::from("hello");
    let s2 = s1.clone();  // æ˜¾å¼å…‹éš†ï¼Œåˆ›å»ºå®Œæ•´å‰¯æœ¬

    println!("  String å…‹éš†:");
    println!("    s1 = \"{}\"", s1);  // âœ… s1 ä»ç„¶æœ‰æ•ˆ
    println!("    s2 = \"{}\"", s2);  // s2 æ˜¯ç‹¬ç«‹çš„å‰¯æœ¬
    println!();

    println!("  Clone åçš„å†…å­˜å¸ƒå±€:");
    println!("  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    println!("  â”‚    s1    â”‚ â”€â”€ptrâ”€â”€> â”‚ hello   â”‚ å †å†…å­˜1");
    println!("  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜");
    println!("  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    println!("  â”‚    s2    â”‚ â”€â”€ptrâ”€â”€> â”‚ hello   â”‚ å †å†…å­˜2ï¼ˆç‹¬ç«‹å‰¯æœ¬ï¼‰");
    println!("  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜");
    println!();

    // Vec çš„å…‹éš†
    let v1 = vec![1, 2, 3];
    let v2 = v1.clone();
    println!("  Vec å…‹éš†:");
    println!("    v1 = {:?}", v1);  // âœ…
    println!("    v2 = {:?}", v2);
    println!();

    // --------------------------------------------------------
    // ğŸ“Œ Copy vs Clone çš„åŒºåˆ«
    // --------------------------------------------------------
    println!("ã€4ã€‘Copy vs Clone å¯¹æ¯”");
    println!();
    println!("  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    println!("  â”‚    ç‰¹æ€§    â”‚      Copy        â”‚      Clone       â”‚");
    println!("  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤");
    println!("  â”‚  è°ƒç”¨æ–¹å¼  â”‚ è‡ªåŠ¨ï¼ˆéšå¼ï¼‰     â”‚ æ‰‹åŠ¨ .clone()    â”‚");
    println!("  â”‚  æ€§èƒ½å¼€é”€  â”‚ æä½ï¼ˆæ ˆå¤åˆ¶ï¼‰   â”‚ å¯èƒ½è¾ƒé«˜ï¼ˆå †å¤åˆ¶ï¼‰â”‚");
    println!("  â”‚  é€‚ç”¨ç±»å‹  â”‚ ç®€å•æ ˆç±»å‹       â”‚ ä»»ä½•ç±»å‹         â”‚");
    println!("  â”‚  è¯­ä¹‰      â”‚ æŒ‰ä½å¤åˆ¶         â”‚ æ·±åº¦å¤åˆ¶         â”‚");
    println!("  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜");
    println!();

    // --------------------------------------------------------
    // ğŸ“Œ å®é™…åº”ç”¨åœºæ™¯
    // --------------------------------------------------------
    println!("ã€5ã€‘ä½•æ—¶ä½¿ç”¨ Cloneï¼Ÿ");
    println!();

    // åœºæ™¯1ï¼šéœ€è¦ä¿ç•™åŸå€¼ï¼ŒåŒæ—¶ä¼ é€’ç»™å‡½æ•°
    let data = String::from("é‡è¦æ•°æ®");
    process_data(data.clone());  // ä¼ é€’å‰¯æœ¬
    println!("  åŸå§‹æ•°æ®ä»å¯ç”¨: \"{}\"", data);
    println!();

    // åœºæ™¯2ï¼šéœ€è¦å¤šä¸ªç‹¬ç«‹çš„å¯å˜å‰¯æœ¬
    let mut list1 = vec![1, 2, 3];
    let mut list2 = list1.clone();
    list1.push(4);
    list2.push(100);
    println!("  ç‹¬ç«‹ä¿®æ”¹:");
    println!("    list1 = {:?}", list1);
    println!("    list2 = {:?}", list2);
    println!();

    println!("  âš ï¸ æ³¨æ„ï¼šClone æœ‰æ€§èƒ½å¼€é”€ï¼Œä¼˜å…ˆè€ƒè™‘å€Ÿç”¨ï¼ˆä¸‹ä¸€èŠ‚è®²ï¼‰");
    println!();

    println!("=== ç¤ºä¾‹ç»“æŸ ===");
    println!("\nğŸ“š ä¸‹ä¸€æ­¥å­¦ä¹ : cargo run --example 04_borrowing");

    wait_for_enter();
}

fn process_data(s: String) {
    println!("  å¤„ç†æ•°æ®: \"{}\"", s);
}

fn wait_for_enter() {
    use std::io::{self, Write};
    println!();
    print!("æŒ‰å›è½¦é”®é€€å‡º...");
    io::stdout().flush().unwrap();
    let mut input = String::new();
    io::stdin().read_line(&mut input).unwrap();
}
